# Django ToDo Website
A simple website to manage tasks!<br>
_Front-End part is generated by [ChatGPT](https://chat.openai.com/)_


# Setup 
Follow this part to run the project locally.
<br>

### 1. Configure Envirement
```
pip install virtualenv
```
```
virtualenv <envirement-name>
```
_On linux_
```
source <envirement-name>/bin/activate
```
_On windows_
```
<envirement-name>\Scripts\activate
```
<br>

### 2. Install Requirements
```
pip install -r requirements.txt
```
<br>

### 3. Run Project
_Install DB_
```
python manage.py makemigrations
```
```
python manage.py migrate
```
_Add admin user_
```
python manage.py createsuperuser
```
_Run the project_
```
python manage.py runserver
```

**Now You Can Enjoy!**
<br>
<br>

# Some Codes
### Models
```python 
class User(models.Model):
    # an id for sequrity!
    id = models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True)
    # an id for cookies!
    public_id = models.CharField(max_length=64, unique=True, editable=False, null=True)
    date_joined = models.DateTimeField(auto_now_add=True)

    def save(self, *args, **kwargs):
        # we rewrite save method to generate public_id.
        if not self.public_id:
            data = f'{self.id}:{self.date_joined}'
            self.public_id = hashlib.sha256(data.encode()).hexdigest()
        super().save(*args, **kwargs)

    def __str__(self):
        return str(self.public_id)

```
### Cookie check decorator
```python
def cookie_check(view_func):
    # a decorator to check request cookie.
    # if there is user_id value, query and pass it to the function.
    # else generate an id, set it in clients search engin.
    def wrapper(request, *args, **kwargs):
        user_id = request.COOKIES.get('user_id')
        if user_id:
            user = User.objects.get(public_id=user_id)
        else:
            user = User.objects.create()
            response = view_func(request, user, *args, **kwargs)
            response.set_cookie('user_id', user.public_id)
            return response

        return view_func(request, user, *args, **kwargs)

    return wrapper
```